### 系统调用

应用程序通过系统调用请求操作系统的服务，系统中的各种共享资源都有操作系统统一掌管，因此在用户程序中，凡事与资源有关的操作(如存储分配，I/O操作，文件管理等)，都必须通过系统调用的方式向操作系统提出服务请求，由操作系统代为完成，这样可以保证系统的稳定性和安全性，防止用户进行非法操作

> 分类 

- 按功能分类

  - 设备管理 完成设备的请求，释放，启动等功能
  - 文件管理 完成文件的读，写，创建，删除等功能
  - 进程控制 完成进程的创建，撤销，阻塞，唤醒等功能
  - 进程通信 完成进程之间的消息传递，信号传递，等功能
  - 内存管理 完成内存的分配，回收等功能

  系统调用相关处理设计到对系统资源的管理，对进程的控制，这些功能需要执行一些特权指令才能完成，因此系统调用的相关处理需要在核心态下进行

> 系统调用与库函数的区别

- 普通应用程序：可直接进行系统调用，也可使用库函数，有的库函数设计系统调用，有的不涉及
- 编程语言：向上提供库函数，有时会将系统调用封装成库函数，以隐藏系统调用的一些细节，使上层进行系统调用更加方便
- 操作系统：向上提供系统调用
- 裸机：

> 系统调用背后的过程

- 用户程序一般由高级语言代码进行编写，可以编译成汇编语言指令
- 汇编语言运行在用户态，运行着编译后的一批指令，在某一时刻，当要发生系统调用时，CPU需要切换用户态到核心态，从用户态到核心态的唯一途径是中断，所以此时发生中断，有一个指令 int x 指令 ，int指令的参数x指明了系统调用号，此处的int不是整数的意思，其实是interrupt的缩写
- 在发生中断后，CPU进入核心态，处理系统调用的某些相关代码，完成后返回到发生中断处
- 用户程序继续执行其他相关指令

传递系统调用参数——>执行陷入指令(用户态)——>执行系统调用相应服务程序(核心态)——>返回用户程序

1. 陷入指令是在用户态执行的，执行陷入指令后立即引发一个内中断，从而CPU进入核心态
2. 发出系统调用请求是在用户态，而对系统调用的相应处理在核心态下进行
3. 陷入指令是唯一一个只能在用户态执行，而不是核心态执行指令

凡事与资源有关的操作，会直接影响到其他进程的操作，一定需要操作系统介入，即需要通过系统调用来实现

系统调用发生在用户态，对系统调用的处理发生在核心态